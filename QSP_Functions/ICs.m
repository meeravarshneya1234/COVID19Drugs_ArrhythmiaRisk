function ic = ICs(settings)
%--------------------------------------------------------------------------
                        %% -- ICs.m -- %%
% Description: extract the initial conditions for the specified state that
% will be studied 

% Inputs:
% --> settings - [struct] simulation protocol settings, must specify
% physiological state and gender. 
% Example: settings.gender = 'M' or 'F'
%          settings.phys_state = 'healthy' or 'HF'

% Outputs: 
% --> ic - [double array] initial condition matrix 
% -------------------------------------------------------------------------
%%
if settings.steady_state   
    switch settings.gender
        case 'M'
            switch settings.phys_state
                case 'healthy'
                    if settings.PCL == 1000
                        ic = [-87.9847893200570,6.98047976781918,6.98056473496110,144.947348061242,144.947325558526,8.79493612106998e-05,8.71185640497765e-05,1.59863314200999,1.52850602811649,0.00735677302588786,0.697514059090735,0.697488314636786,0.697343643533984,0.454220857157535,0.697245658360403,0.000188874752718713,0.493301543511300,0.260755506390886,0.00100225564013399,0.999552809796377,0.537122937907233,0.000510676592024418,0.999552821116974,0.588980295719346,2.35029892404249e-09,0.999999990831525,0.898657786515245,0.999999990831624,0.999484416242678,0.999907345578524,0.00303206883107725,0.999999990810960,0.999999990826513,8.58724719169921e-06,0.503190456100217,0.287968026817813,0.000193249317931226,0.996764435668939,2.26334532938209e-07,2.82676620943195e-07,0.0127543271475598];
                    else
                        disp('SS ICs not measured. Using the PCL = 1000ms inital conditions. Consider running for more beats to reach SS.')
                        ic = [-87.9847893200570,6.98047976781918,6.98056473496110,144.947348061242,144.947325558526,8.79493612106998e-05,8.71185640497765e-05,1.59863314200999,1.52850602811649,0.00735677302588786,0.697514059090735,0.697488314636786,0.697343643533984,0.454220857157535,0.697245658360403,0.000188874752718713,0.493301543511300,0.260755506390886,0.00100225564013399,0.999552809796377,0.537122937907233,0.000510676592024418,0.999552821116974,0.588980295719346,2.35029892404249e-09,0.999999990831525,0.898657786515245,0.999999990831624,0.999484416242678,0.999907345578524,0.00303206883107725,0.999999990810960,0.999999990826513,8.58724719169921e-06,0.503190456100217,0.287968026817813,0.000193249317931226,0.996764435668939,2.26334532938209e-07,2.82676620943195e-07,0.0127543271475598];
                    end
                    
                case 'HF'
                    if settings.PCL == 1000
                        ic = [-87.5945072641389,8.24670857842623,8.24688112711638,143.836570569223,143.836547940215,0.000108066409861259,0.000103527734355766,0.792010883054622,0.772544626699034,0.00765120645386757,0.683814568063708,0.683758858861297,0.683467586022165,0.438272767368363,0.683287430373890,0.000203407627979175,0.483114878807756,0.249381573831295,0.00102898146109393,0.999521094773279,0.567332138599787,0.000524301006515991,0.999521119316426,0.615198854155005,2.57752998171332e-09,0.999999989807136,0.893647907391486,0.999999989807357,0.999720194325171,0.999960507855774,0.00583911091962122,0.999999989816980,0.999999989797834,8.74050286076340e-06,0.477228797374638,0.308053061271016,0.000201977743109671,0.996865873404459,2.25728228678367e-09,2.82008315205637e-09,0.00413412149413438];
                    else
                        disp('SS ICs not measured. Using the PCL = 1000ms inital conditions. Consider running for more beats to reach SS.')
                        ic = [-87.5945072641389,8.24670857842623,8.24688112711638,143.836570569223,143.836547940215,0.000108066409861259,0.000103527734355766,0.792010883054622,0.772544626699034,0.00765120645386757,0.683814568063708,0.683758858861297,0.683467586022165,0.438272767368363,0.683287430373890,0.000203407627979175,0.483114878807756,0.249381573831295,0.00102898146109393,0.999521094773279,0.567332138599787,0.000524301006515991,0.999521119316426,0.615198854155005,2.57752998171332e-09,0.999999989807136,0.893647907391486,0.999999989807357,0.999720194325171,0.999960507855774,0.00583911091962122,0.999999989816980,0.999999989797834,8.74050286076340e-06,0.477228797374638,0.308053061271016,0.000201977743109671,0.996865873404459,2.25728228678367e-09,2.82008315205637e-09,0.00413412149413438];
                    end
            end
            
        case 'F'
            
            switch settings.phys_state
                case 'healthy'
                    if settings.PCL == 1000
                        ic = [-87.9139086310943,7.28552732365202,7.28559953234206,144.597256200513,144.597236105983,8.13998743077865e-05,8.03556194823422e-05,1.83458864847406,1.78743207644371,0.00740939624907986,0.695051287190518,0.695035993460339,0.694948249844712,0.451374098017751,0.694887268883369,0.000191434652390605,0.494223957756947,0.256891500271000,0.00100705283840834,0.999547263266940,0.565899357905298,0.000513122103955288,0.999547270057558,0.614634834763419,2.38999307612623e-09,0.999999990655128,0.892287016301326,0.999999990655181,0.999703298051338,0.999959872541257,0.00222348102669716,0.999999990653693,0.999999990652584,8.34052518458119e-06,0.476041891823688,0.306949999552858,0.000194751755613579,0.996782759918869,3.43432948346748e-07,4.29178713278382e-07,0.0141668272596266];
                    else
                        disp('SS ICs not measured. Using the PCL = 1000ms inital conditions. Consider running for more beats to reach SS.')
                        ic = [-87.9139086310943,7.28552732365202,7.28559953234206,144.597256200513,144.597236105983,8.13998743077865e-05,8.03556194823422e-05,1.83458864847406,1.78743207644371,0.00740939624907986,0.695051287190518,0.695035993460339,0.694948249844712,0.451374098017751,0.694887268883369,0.000191434652390605,0.494223957756947,0.256891500271000,0.00100705283840834,0.999547263266940,0.565899357905298,0.000513122103955288,0.999547270057558,0.614634834763419,2.38999307612623e-09,0.999999990655128,0.892287016301326,0.999999990655181,0.999703298051338,0.999959872541257,0.00222348102669716,0.999999990653693,0.999999990652584,8.34052518458119e-06,0.476041891823688,0.306949999552858,0.000194751755613579,0.996782759918869,3.43432948346748e-07,4.29178713278382e-07,0.0141668272596266];
                    end
                    
                case 'HF'
                    if settings.PCL == 1000
                        ic = [-87.4645952570319,8.74452897325438,8.74469427198743,143.317492288137,143.317471100506,0.000105968428656487,0.000101724294606879,0.896336371718107,0.868258411470217,0.00775178482913484,0.679181092147989,0.679112603567433,0.678751640836313,0.432980272844943,0.678524541203405,0.000208489051698982,0.473440893626136,0.235250267463481,0.00103803528655357,0.999510037805243,0.544602027017155,0.000528916589247945,0.999510068266222,0.589352126164104,2.65794523595968e-09,0.999999989441318,0.881963912428871,0.999999989441349,0.999613008900952,0.999944006465688,0.00546416396339060,0.999999989731899,0.999999989429268,9.19644317018765e-06,0.500718153756202,0.330210127956962,0.000204974323487846,0.996898985321869,5.84479755271795e-09,7.30051480932706e-09,0.00541654952026266];
                    else
                        disp('SS ICs not measured. Using the PCL = 1000ms inital conditions. Consider running for more beats to reach SS.')
                        ic = [-87.4645952570319,8.74452897325438,8.74469427198743,143.317492288137,143.317471100506,0.000105968428656487,0.000101724294606879,0.896336371718107,0.868258411470217,0.00775178482913484,0.679181092147989,0.679112603567433,0.678751640836313,0.432980272844943,0.678524541203405,0.000208489051698982,0.473440893626136,0.235250267463481,0.00103803528655357,0.999510037805243,0.544602027017155,0.000528916589247945,0.999510068266222,0.589352126164104,2.65794523595968e-09,0.999999989441318,0.881963912428871,0.999999989441349,0.999613008900952,0.999944006465688,0.00546416396339060,0.999999989731899,0.999999989429268,9.19644317018765e-06,0.500718153756202,0.330210127956962,0.000204974323487846,0.996898985321869,5.84479755271795e-09,7.30051480932706e-09,0.00541654952026266];
                    end
            end
    end
else 
    ic = [-87 7 7 145 145 1.0e-4 1.0e-4 1.2 1.2 0 1 1 1 1 1 0 1 1 0 1 1 0 1 1 0 1 1 1 1 1 0 1 1 0 0 0 0 1 0 0 0];
end


